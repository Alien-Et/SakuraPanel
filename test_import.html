<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试订阅导入功能</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #ffe6f0, #fff0f5);
        }
        .test-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .test-button {
            background: linear-gradient(to right, #ff69b4, #ff1493);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            transition: transform 0.2s ease;
        }
        .test-button:hover {
            transform: scale(1.05);
        }
        .test-result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            background: #f0f8ff;
            border-left: 4px solid #4CAF50;
        }
        .device-info {
            background: #e8f5e8;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>🌸 订阅导入功能测试</h1>
    
    <div class="test-section">
        <h2>📱 设备信息检测</h2>
        <div id="deviceInfo" class="device-info"></div>
    </div>
    
    <div class="test-section">
        <h2>🔗 订阅导入测试</h2>
        <p>测试新的订阅导入功能，支持电脑和手机设备：</p>
        
        <button class="test-button" onclick="testMobileImport()">📱 模拟手机导入</button>
        <button class="test-button" onclick="testDesktopImport()">💻 模拟电脑导入</button>
        <button class="test-button" onclick="testCopyLink()">📋 测试复制链接</button>
        <button class="test-button" onclick="testViewConfig()">👁️ 测试查看配置</button>
        
        <div id="testResult" class="test-result" style="display: none;"></div>
    </div>
    
    <div class="test-section">
        <h2>💡 使用说明</h2>
        <h3>📱 手机用户：</h3>
        <ol>
            <li>点击"一键导入"按钮</li>
            <li>订阅链接会自动复制到剪贴板</li>
            <li>如果安装了支持的客户端，会尝试自动打开</li>
            <li>如果没有自动打开，手动打开客户端并选择"从剪贴板导入"</li>
        </ol>
        
        <h3>💻 电脑用户：</h3>
        <ol>
            <li>点击"一键导入"按钮</li>
            <li>订阅链接会自动复制到剪贴板</li>
            <li>打开您的代理客户端</li>
            <li>找到"导入配置"或"订阅管理"选项</li>
            <li>粘贴链接或选择"从剪贴板导入"</li>
        </ol>
        
        <h3>🔧 备用选项：</h3>
        <ul>
            <li><strong>复制链接：</strong>直接复制订阅链接到剪贴板</li>
            <li><strong>查看配置：</strong>在新窗口中打开配置内容，可以手动复制</li>
        </ul>
    </div>

    <script>
        // 显示设备信息
        function showDeviceInfo() {
            const deviceInfo = document.getElementById('deviceInfo');
            const userAgent = navigator.userAgent;
            const isMobile = /Mobile|Android|iPhone|iPad|iPod/i.test(userAgent);
            
            let deviceType = '💻 电脑';
            if (/iPhone/i.test(userAgent)) deviceType = '📱 iPhone';
            else if (/iPad/i.test(userAgent)) deviceType = '📱 iPad';
            else if (/Android/i.test(userAgent)) deviceType = '📱 Android';
            else if (/Mobile/i.test(userAgent)) deviceType = '📱 手机';
            
            deviceInfo.innerHTML = `
                <strong>设备类型：</strong>${deviceType}<br>
                <strong>用户代理：</strong>${userAgent.substring(0, 100)}...<br>
                <strong>剪贴板支持：</strong>${navigator.clipboard ? '✅ 支持' : '❌ 不支持'}
            `;
        }
        
        // 测试手机导入
        function testMobileImport() {
            const result = document.getElementById('testResult');
            const isMobile = /Mobile|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
            
            let message = '📱 手机导入测试：<br>';
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                message += '✅ 支持自动复制到剪贴板<br>';
                
                // 模拟复制过程
                navigator.clipboard.writeText('https://example.com/config/v2rayng').then(() => {
                    message += '✅ 链接已成功复制到剪贴板<br>';
                    message += '📋 订阅链接：https://example.com/config/v2rayng<br>';
                    message += '💡 请手动打开客户端并选择"从剪贴板导入"';
                    
                    result.innerHTML = message;
                    result.style.display = 'block';
                }).catch(() => {
                    message += '❌ 自动复制失败，需要手动复制<br>';
                    result.innerHTML = message;
                    result.style.display = 'block';
                });
            } else {
                message += '❌ 不支持自动复制功能<br>';
                message += '💡 需要手动复制订阅链接';
                
                result.innerHTML = message;
                result.style.display = 'block';
            }
        }
        
        // 测试电脑导入
        function testDesktopImport() {
            const result = document.getElementById('testResult');
            
            let message = '💻 电脑导入测试：<br>';
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                message += '✅ 支持自动复制到剪贴板<br>';
                
                navigator.clipboard.writeText('https://example.com/config/clash').then(() => {
                    message += '✅ 链接已成功复制到剪贴板<br>';
                    message += '📋 订阅链接：https://example.com/config/clash<br>';
                    message += '💡 请打开客户端并找到"导入配置"或"订阅管理"选项';
                    
                    result.innerHTML = message;
                    result.style.display = 'block';
                }).catch(() => {
                    message += '❌ 自动复制失败<br>';
                    result.innerHTML = message;
                    result.style.display = 'block';
                });
            } else {
                message += '❌ 不支持自动复制功能<br>';
                message += '💡 需要手动复制订阅链接';
                
                result.innerHTML = message;
                result.style.display = 'block';
            }
        }
        
        // 测试复制链接
        function testCopyLink() {
            const result = document.getElementById('testResult');
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText('https://example.com/config/test').then(() => {
                    result.innerHTML = '📋 复制链接测试：<br>✅ 链接已成功复制到剪贴板！<br>💡 订阅链接：https://example.com/config/test';
                    result.style.display = 'block';
                }).catch(() => {
                    result.innerHTML = '📋 复制链接测试：<br>❌ 自动复制失败，需要手动复制';
                    result.style.display = 'block';
                });
            } else {
                result.innerHTML = '📋 复制链接测试：<br>❌ 不支持自动复制功能，需要手动复制';
                result.style.display = 'block';
            }
        }
        
        // 测试查看配置
        function testViewConfig() {
            const result = document.getElementById('testResult');
            result.innerHTML = '👁️ 查看配置测试：<br>✅ 配置将在新窗口中打开<br>💡 您可以查看配置内容并手动复制到客户端';
            result.style.display = 'block';
            
            // 模拟打开新窗口
            setTimeout(() => {
                if (confirm('配置内容示例：\n\n' +
                           'proxies:\n' +
                           '  - name: "测试节点"\n' +
                           '    type: vless\n' +
                           '    server: example.com\n' +
                           '    port: 443\n' +
                           '    ...\n\n' +
                           '需要复制链接吗？')) {
                    testCopyLink();
                }
            }, 500);
        }
        
        // 页面加载时显示设备信息
        window.onload = function() {
            showDeviceInfo();
        };
    </script>
</body>
</html>